[gd_scene load_steps=25 format=3 uid="uid://db8yeocanp3on"]

[ext_resource type="Script" uid="uid://d1ak3yy7w4840" path="res://Scripts/map.gd" id="1_fls3e"]
[ext_resource type="Texture2D" uid="uid://c43wpnx4ohjw7" path="res://Textures/Ground003_1K-PNG/ground.png" id="2_j4oe2"]
[ext_resource type="AudioStream" uid="uid://ch7vdt8jlicon" path="res://Sounds/bbc_wind-atmos_nhu1021772.mp3" id="2_k63oc"]
[ext_resource type="MeshLibrary" uid="uid://b6s28sscqgft8" path="res://folliage_mesh.tres" id="2_riaky"]
[ext_resource type="Texture2D" uid="uid://pqm5i1ud2tp4" path="res://Textures/Ground003_1K-PNG/ground_n.png" id="3_k63oc"]
[ext_resource type="Texture2D" uid="uid://dbi01n57xyi04" path="res://Textures/NightSkyHDRI003_1K/NightSkyHDRI003.png" id="5_j4oe2"]
[ext_resource type="PackedScene" uid="uid://dlgnwojhaerho" path="res://Scenes/player.tscn" id="6_ie368"]
[ext_resource type="PackedScene" uid="uid://cudpxak7ruepq" path="res://Textures/street_lamp_01_1k/street_lamp_01_1k.fbx" id="13_x5dfk"]
[ext_resource type="PackedScene" uid="uid://vw60otvfw2xt" path="res://Scenes/pnj.tscn" id="14_ie368"]
[ext_resource type="AudioStream" uid="uid://cnbegmfen1a60" path="res://Sounds/bbc_fire---clo_nhu0500808.mp3" id="15_fls3e"]
[ext_resource type="Script" uid="uid://b1e5oskre1y64" path="res://Scripts/ui.gd" id="15_x5dfk"]
[ext_resource type="FontFile" uid="uid://dm472n6vwgn6h" path="res://Fonts/PixelifySans-VariableFont_wght.ttf" id="16_riaky"]
[ext_resource type="MeshLibrary" uid="uid://cge05mtfk8c1h" path="res://treess_mesh.tres" id="17_k63oc"]
[ext_resource type="PackedScene" uid="uid://1oa26n5tdp2s" path="res://Scenes/journal.tscn" id="17_rg57b"]
[ext_resource type="PackedScene" uid="uid://dxvisy516q6f6" path="res://Scenes/seat_node.tscn" id="18_j4oe2"]
[ext_resource type="PackedScene" uid="uid://30vj554jixit" path="res://Scenes/fire.tscn" id="18_riaky"]
[ext_resource type="Script" uid="uid://rw33bmqa2c7u" path="res://Scripts/initialize_pnj.gd" id="21_macow"]

[sub_resource type="BoxShape3D" id="BoxShape3D_k63oc"]
size = Vector3(1000, 0.1, 1000)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_riaky"]
albedo_texture = ExtResource("2_j4oe2")
normal_enabled = true
normal_texture = ExtResource("3_k63oc")
uv1_scale = Vector3(50, 50, 50)
texture_filter = 0

[sub_resource type="PlaneMesh" id="PlaneMesh_vtkp8"]
material = SubResource("StandardMaterial3D_riaky")
size = Vector2(100, 100)

[sub_resource type="PanoramaSkyMaterial" id="PanoramaSkyMaterial_np2xp"]
panorama = ExtResource("5_j4oe2")
energy_multiplier = 86.8

[sub_resource type="Sky" id="Sky_w7jjh"]
sky_material = SubResource("PanoramaSkyMaterial_np2xp")

[sub_resource type="Environment" id="Environment_6q3n4"]
background_mode = 2
background_energy_multiplier = 2.5
sky = SubResource("Sky_w7jjh")
ambient_light_source = 1
ambient_light_color = Color(1, 1, 1, 1)
fog_light_color = Color(0.46930748, 0.504759, 0.5579392, 1)
fog_light_energy = 0.95
fog_sun_scatter = 0.08
fog_density = 0.001
fog_sky_affect = 0.72
fog_height_density = -1.9131
volumetric_fog_enabled = true
volumetric_fog_density = 0.068
volumetric_fog_albedo = Color(0.40069774, 0.40069774, 0.40069768, 1)
volumetric_fog_emission_energy = 2.15
volumetric_fog_length = 88.2
volumetric_fog_sky_affect = 0.75

[sub_resource type="CylinderShape3D" id="CylinderShape3D_fls3e"]
height = 3.303955
radius = 1.3520508

[node name="Map" type="Node3D"]
script = ExtResource("1_fls3e")

[node name="AudioStreamPlayer3D" type="AudioStreamPlayer3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.029435135, 7.1224074, -0.103872105)
stream = ExtResource("2_k63oc")
volume_db = -10.0
autoplay = true
max_distance = 2005.33
parameters/looping = true

[node name="folliage" type="GridMap" parent="."]
mesh_library = ExtResource("2_riaky")
cell_size = Vector3(1, 1.905, 1)
cell_octant_size = 25
data = {
"cells": PackedInt32Array(1, 65527, 1507328, 65531, 65524, 1507328, 65531, 65514, 1507328, 9, 65514, 1507328, 19, 65524, 1507328, 21, 65532, 1507328, 65520, 65524, 1507328, 65514, 65532, 1507328, 65512, 5, 1507328, 65514, 12, 1507328, 65520, 14, 1507328, 65522, 3, 1507328, 65534, 10, 1507328, 7, 17, 1507328, 7, 16, 1507328, 18, 6, 1507328, 3, 7, 1507328, 10, 65528, 1507328, 10, 65529, 1507328, 65520, 65533, 1507328)
}

[node name="StaticBody3D" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.84302044, 0)

[node name="CollisionShape3D" type="CollisionShape3D" parent="StaticBody3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.57760596, 0)
shape = SubResource("BoxShape3D_k63oc")

[node name="Ground" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.003435135, 0.03195572, 0.0381279)
mesh = SubResource("PlaneMesh_vtkp8")

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_6q3n4")

[node name="Player" parent="." instance=ExtResource("6_ie368")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 4.923, 0, 0)

[node name="PNJ1" parent="." instance=ExtResource("14_ie368")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -5.1238375, 0, 0)

[node name="PNJ2" parent="." instance=ExtResource("14_ie368")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4.1238375, 0, -3.0696833)

[node name="PNJ3" parent="." instance=ExtResource("14_ie368")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.608839, 0, -4.9411526)

[node name="PNJ4" parent="." instance=ExtResource("14_ie368")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.6393037, 0, -4.9158683)

[node name="PNJ5" parent="." instance=ExtResource("14_ie368")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 4.0664635, -0.026843071, -2.9624572)

[node name="PNJ6" parent="." instance=ExtResource("14_ie368")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 4.0915413, 0, 2.927822)

[node name="PNJ7" parent="." instance=ExtResource("14_ie368")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.5891066, 0, 4.761803)

[node name="PNJ8" parent="." instance=ExtResource("14_ie368")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.486301, 0, 4.8153763)

[node name="PNJ9" parent="." instance=ExtResource("14_ie368")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -3.975385, 0, 2.831035)

[node name="UI" type="CanvasLayer" parent="."]
script = ExtResource("15_x5dfk")

[node name="CurrentWeek" type="Label" parent="UI"]
texture_filter = 1
offset_left = 16.0
offset_top = 16.0
offset_right = 96.0
offset_bottom = 39.0
theme_override_fonts/font = ExtResource("16_riaky")
text = "Semaine 1"

[node name="Lives" type="Label" parent="UI"]
texture_filter = 1
offset_left = 16.0
offset_top = 39.0
offset_right = 96.0
offset_bottom = 62.0
theme_override_fonts/font = ExtResource("16_riaky")
text = "2 vies"

[node name="TimeLeft" type="Label" parent="UI"]
texture_filter = 1
offset_left = 16.0
offset_top = 62.0
offset_right = 96.0
offset_bottom = 85.0
theme_override_fonts/font = ExtResource("16_riaky")
text = "10:00 restantes"

[node name="DialoguesLeft" type="Label" parent="UI"]
texture_filter = 1
offset_left = 16.0
offset_top = 88.0
offset_right = 135.0
offset_bottom = 111.0
theme_override_fonts/font = ExtResource("16_riaky")
text = "Dialogues restants : 3"

[node name="FadeBlack" type="ColorRect" parent="UI"]
visible = false
offset_right = 1280.0
offset_bottom = 720.0
color = Color(0, 0, 0, 1)

[node name="DeadText" type="Label" parent="UI/FadeBlack"]
texture_filter = 1
layout_mode = 0
offset_right = 1280.0
offset_bottom = 720.0
theme_override_fonts/font = ExtResource("16_riaky")
theme_override_font_sizes/font_size = 64
text = "Temps écoulé
Le maire est mort"
horizontal_alignment = 1
vertical_alignment = 1

[node name="ReplayButton" type="Button" parent="UI/FadeBlack"]
texture_filter = 1
layout_mode = 0
offset_left = 480.0
offset_top = 496.0
offset_right = 800.0
offset_bottom = 568.0
theme_override_fonts/font = ExtResource("16_riaky")
theme_override_font_sizes/font_size = 32
text = "Rejouer"

[node name="HistoryDayBack" type="ColorRect" parent="UI"]
offset_right = 1280.0
offset_bottom = 720.0
color = Color(0, 0, 0, 0.6862745)

[node name="StartHistoryDay" type="Label" parent="UI"]
texture_filter = 1
offset_right = 1280.0
offset_bottom = 720.0
theme_override_colors/font_shadow_color = Color(0, 0, 0, 0.6862745)
theme_override_constants/shadow_offset_x = 2
theme_override_constants/shadow_offset_y = 2
theme_override_fonts/font = ExtResource("16_riaky")
theme_override_font_sizes/font_size = 32
text = "Voici l'histoire du jour"
horizontal_alignment = 1
vertical_alignment = 1
autowrap_mode = 3

[node name="HistorySkipButton" type="Button" parent="UI"]
texture_filter = 1
offset_left = 1088.0
offset_top = 648.0
offset_right = 1248.0
offset_bottom = 695.0
theme_override_fonts/font = ExtResource("16_riaky")
theme_override_font_sizes/font_size = 32
text = "Ignorer"

[node name="Journal" parent="UI" instance=ExtResource("17_rg57b")]

[node name="seatNode01" parent="." groups=["Seat_PNJ"] instance=ExtResource("18_j4oe2")]
transform = Transform3D(-6.3818625e-08, 0, 1.4599999, 0, 1.4599999, 0, -1.4599999, 0, -6.3818625e-08, -5, 0.05, 0)

[node name="seatNode02" parent="." groups=["Seat_PNJ"] instance=ExtResource("18_j4oe2")]
transform = Transform3D(1.032376, 0, 1.032376, 0, 1.4599999, 0, -1.032376, 0, 1.032376, -4.045, 0.05, -2.939)

[node name="seatNode03" parent="." groups=["Seat_PNJ"] instance=ExtResource("18_j4oe2")]
transform = Transform3D(1.4599999, 0, 0, 0, 1.4599999, 0, 0, 0, 1.4599999, -1.545, 0.05, -4.755)

[node name="seatNode04" parent="." groups=["Seat_PNJ"] instance=ExtResource("18_j4oe2")]
transform = Transform3D(1.3232093, 0, -0.61702263, 0, 1.4599997, 0, 0.61702263, 0, 1.3232093, 1.545, 0.05, -4.755)

[node name="seatNode05" parent="." groups=["Seat_PNJ"] instance=ExtResource("18_j4oe2")]
transform = Transform3D(0.72999996, 0, -1.2643971, 0, 1.4599999, 0, 1.2643971, 0, 0.72999996, 4.045, 0, -2.939)

[node name="seatNodePlayer6" parent="." groups=["Seat_PNJ"] instance=ExtResource("18_j4oe2")]
transform = Transform3D(-0.039033532, 0, -1.459478, 0, 1.4599999, 0, 1.459478, 0, -0.039033532, 5, 0, 0)

[node name="seatNode06" parent="." groups=["Seat_PNJ"] instance=ExtResource("18_j4oe2")]
transform = Transform3D(-0.72999996, 0, -1.2643969, 0, 1.4599998, 0, 1.2643969, 0, -0.72999996, 4.045, 0.05, 2.939)

[node name="seatNode07" parent="." groups=["Seat_PNJ"] instance=ExtResource("18_j4oe2")]
transform = Transform3D(-1.3719511, 0, -0.49934947, 0, 1.4599998, 0, 0.49934947, 0, -1.3719511, 1.545, 0, 4.755)

[node name="seatNode08" parent="." groups=["Seat_PNJ"] instance=ExtResource("18_j4oe2")]
transform = Transform3D(-1.3719509, 0, 0.49934942, 0, 1.4599998, 0, -0.49934942, 0, -1.3719509, -1.545, 0.05, 4.755)

[node name="seatNode09" parent="." groups=["Seat_Player"] instance=ExtResource("18_j4oe2")]
transform = Transform3D(-0.7299999, 0, 1.2643968, 0, 1.4599998, 0, -1.2643968, 0, -0.7299999, -4.045, 0.05, 2.939)

[node name="trees" type="GridMap" parent="."]
mesh_library = ExtResource("17_k63oc")
cell_size = Vector3(1, 20, 1)
data = {
"cells": PackedInt32Array(10, 65524, 0, 65524, 65528, 0, 65530, 13, 0, 10, 7, 0, 21, 65505, 0, 17, 65504, 0, 12, 65504, 0, 7, 65504, 0, 1, 65505, 0, 65532, 65507, 0, 65526, 65510, 0, 65521, 65513, 0, 65516, 65517, 0, 65511, 65523, 0, 65508, 65529, 0, 65512, 65519, 0, 65508, 65526, 0, 65506, 65534, 0, 65507, 3, 0, 65503, 65531, 0, 65504, 2, 0, 65507, 8, 0, 65509, 13, 0, 65512, 16, 0, 65515, 18, 0, 65519, 21, 0, 65524, 22, 0, 65530, 23, 0, 0, 23, 0, 6, 22, 0, 12, 21, 0, 17, 18, 0, 22, 14, 0, 25, 9, 0, 28, 3, 0, 28, 65533, 0, 28, 65527, 0, 29, 65521, 0, 27, 65515, 0, 26, 65508, 0, 6, 65507, 0, 11, 65507, 0, 16, 65509, 0, 20, 65512, 0, 23, 65516, 0, 26, 65519, 0, 65517, 65514, 0, 65522, 65510, 0, 65529, 65508, 0, 65534, 65504, 0, 3, 65505, 0, 31, 6, 0, 31, 65517, 0, 33, 65522, 0, 32, 65528, 0, 30, 65525, 0, 33, 65529, 0, 30, 0, 0, 28, 7, 0, 30, 65532, 0, 26, 13, 0, 20, 18, 0, 16, 22, 0, 9, 24, 0, 3, 25, 0, 65533, 26, 0, 65527, 26, 0, 65520, 25, 0, 65516, 21, 0, 65506, 11, 0, 65504, 6, 0, 65522, 28, 0, 1, 65515, 0, 65527, 65519, 0, 65517, 5, 0, 16, 65535, 0, 13, 65516, 0, 65515, 65511, 0, 65514, 65507, 0, 65512, 65503, 0, 65509, 65501, 0, 65506, 65498, 0, 65502, 65497, 0, 65501, 65497, 0, 65499, 65497, 0, 65496, 65499, 0, 65495, 65499, 0, 65493, 65498, 0, 65492, 65498, 0, 65490, 65499, 0, 65489, 65501, 0, 65487, 65506, 0, 65488, 65511, 0, 65489, 65511, 0, 65489, 65512, 0, 65491, 65515, 0, 65491, 65518, 0, 65491, 65519, 0, 65494, 65522, 0, 65494, 65523, 0, 65496, 65527, 0, 65500, 65532, 0, 65503, 65534, 0, 65487, 65503, 0, 65487, 65508, 0, 65497, 65531, 0, 65495, 65530, 0, 65492, 65528, 0, 65491, 65522, 0, 65488, 65514, 0, 65494, 65495, 0, 65497, 65493, 0, 65498, 65493, 0, 65499, 65493, 0, 65499, 65494, 0, 65500, 65494, 0, 65501, 65494, 0, 65502, 65494, 0, 65503, 65494, 0, 65504, 65495, 0, 65505, 65495, 0, 65506, 65495, 0, 65506, 65496, 0, 65507, 65496, 0, 65508, 65496, 0, 65508, 65497, 0, 65509, 65498, 0, 65510, 65499, 0, 65511, 65500, 0, 65512, 65501, 0, 65512, 65502, 0, 65513, 65503, 0, 65514, 65503, 0, 65514, 65504, 0, 65515, 65504, 0, 65515, 65505, 0, 65516, 65506, 0, 65516, 65507, 0, 65517, 65508, 0, 65517, 65509, 0, 65517, 65510, 0, 65517, 65511, 0)
}

[node name="street_lamp_01_1k" parent="." instance=ExtResource("13_x5dfk")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -38.51703, -0.21541524, -24.687088)

[node name="OmniLight3D" type="OmniLight3D" parent="street_lamp_01_1k"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 3.4202003, 0)
light_color = Color(0.83015203, 0.5735766, 1.540184e-06, 1)
light_energy = 2.462
omni_range = 40.0
omni_attenuation = 0.575
omni_shadow_mode = 0

[node name="street_lamp_01_1k" parent="street_lamp_01_1k" instance=ExtResource("13_x5dfk")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 7.4753838, -0.21541524, -0.1302948)

[node name="OmniLight3D" type="OmniLight3D" parent="street_lamp_01_1k/street_lamp_01_1k"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 3.4202003, 0)
light_color = Color(0.83015203, 0.5735766, 1.540184e-06, 1)
light_energy = 2.462
omni_range = 40.0
omni_attenuation = 0.575
omni_shadow_mode = 0

[node name="street_lamp_01_1k2" parent="street_lamp_01_1k" instance=ExtResource("13_x5dfk")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.21407318, -0.21541524, 11.093738)

[node name="OmniLight3D" type="OmniLight3D" parent="street_lamp_01_1k/street_lamp_01_1k2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 3.4202003, 0)
light_color = Color(0.83015203, 0.5735766, 1.540184e-06, 1)
light_energy = 2.462
omni_range = 40.0
omni_attenuation = 0.575
omni_shadow_mode = 0

[node name="street_lamp_01_1k" parent="street_lamp_01_1k/street_lamp_01_1k2" instance=ExtResource("13_x5dfk")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 7.4753838, -0.21541524, -0.1302948)

[node name="OmniLight3D" type="OmniLight3D" parent="street_lamp_01_1k/street_lamp_01_1k2/street_lamp_01_1k"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 3.4202003, 0)
light_color = Color(0.83015203, 0.5735766, 1.540184e-06, 1)
light_energy = 2.462
omni_range = 40.0
omni_attenuation = 0.575
omni_shadow_mode = 0

[node name="dead_tree_trunk_4k" parent="." instance=ExtResource("18_riaky")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.026, -0.01987809, 0.142)

[node name="AudioStreamPlayer3D" type="AudioStreamPlayer3D" parent="dead_tree_trunk_4k"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.029435135, 0.05183381, -0.103872105)
stream = ExtResource("15_fls3e")
volume_db = -30.0
autoplay = true
parameters/looping = true

[node name="OmniLight3D" type="OmniLight3D" parent="dead_tree_trunk_4k"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.62834597, 0)
light_color = Color(0.83015203, 0.5735766, 1.540184e-06, 1)
light_energy = 2.462
omni_range = 40.0
omni_attenuation = 0.575
omni_shadow_mode = 0

[node name="StaticBody3D" type="StaticBody3D" parent="dead_tree_trunk_4k"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.10719206, 0.91145295, 0.20856686)

[node name="CollisionShape3D" type="CollisionShape3D" parent="dead_tree_trunk_4k/StaticBody3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.48156738, 0)
shape = SubResource("CylinderShape3D_fls3e")

[node name="CinematicCamera" type="Camera3D" parent="."]
transform = Transform3D(1, 0, 0, 0, -4.371139e-08, 1, 0, -1, -4.371139e-08, 0, 4, 0)

[node name="InitializePNJ" type="Node3D" parent="."]
script = ExtResource("21_macow")

[connection signal="pressed" from="UI/FadeBlack/ReplayButton" to="UI" method="_on_replay_button_pressed"]
[connection signal="pressed" from="UI/HistorySkipButton" to="UI" method="_on_history_skip_button_pressed"]
